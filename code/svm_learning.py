import main
from sklearn.svm import SVC
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score, confusion_matrix, precision_score, recall_score, f1_score
from sklearn.model_selection import GridSearchCV
from sklearn.metrics import classification_report


print ("Reading data ...")
x_all, y_all = main.read(data=False)
x_train, x_test, y_train, y_test = train_test_split(x_all, y_all, test_size=0.3, random_state=42)
print (x_train.shape, y_train.shape)
print (x_test.shape, y_test.shape)

models = [SVC(),
          SVC(C=1000, cache_size=200, class_weight=None, coef0=0.0,
              decision_function_shape='ovr', degree=3, gamma=0.01, kernel='rbf',
              max_iter=-1, probability=False, random_state=None, shrinking=True,
              tol=0.001, verbose=False)
          ]
for model in models:
    print ("Fitting SVM ...")
    model.fit(x_train, y_train)

    print ("Evaluating ...")
    y_pred = model.predict(x_test)

    print ("Accuracy is %f." % accuracy_score(y_test, y_pred))
    print (confusion_matrix(y_test, y_pred))
    print ("Precision score is %f." % precision_score(y_test, y_pred))
    print ("Recall score is %f." % recall_score(y_test, y_pred))
    print ("F1 score is %f." % f1_score(y_test, y_pred))
    print ("-----------------------------------")


